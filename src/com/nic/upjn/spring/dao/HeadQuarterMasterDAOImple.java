package com.nic.upjn.spring.dao;

import java.util.List;

import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.nic.upjn.spring.entity.PpPlacemaster;

@Repository("HeadQuarterMasterDAO")
public class HeadQuarterMasterDAOImple implements HeadQuarterMasterDAO {
	
	@Autowired
	SessionFactory sessionfactory;

	@Override
	public List getList(String condition, String namedQuery) {
		
		Query query = null;
		List list = null;
		
		Session session = sessionfactory.openSession();
		Transaction tx = session.beginTransaction();
		
		try{
			if(condition == null){
				query = session.getNamedQuery(namedQuery);
				list = query.list();
			}
			else{
				query = session.getNamedQuery(namedQuery);
				query.setString(0, condition);
				list = query.list();
			}
		}
		catch(Exception e){
			e.printStackTrace();
		}
		 finally {
				session.close();
			}
		
		return list;
	}

	@Override
	public List checkExistanceOfPlaceName(String place, Integer masDistrictid) {
		List list = null;

		Session session = null;
		try {

			session = sessionfactory.openSession();
			Transaction t = session.beginTransaction();

			Query query = session
					.createSQLQuery("SELECT * FROM Pp_PlaceMaster WHERE mas_DistrictID="+masDistrictid+" AND place='"+place+"'");

			list = query.list();

			t.commit();
			
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			session.close();
		}

		return list;
	}

	@Override
	public int AddPlace(PpPlacemaster placemaster) {
		Session session = null;
		int result = 0;
		try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
			session = sessionfactory.openSession();
			Transaction t = session.beginTransaction();
			
			placemaster.setZoneCode(null);
			placemaster.setZoneDesc(null);

			session.save(placemaster);
			t.commit();
			result = 1;
			
		} 
		catch (Exception e) {
			e.printStackTrace();
		} finally {
			session.close();
		}
		return result;
	}

	@Override
	public Boolean deleteHeadQuarter(String ppPlacemasterid) {
		boolean result = false;
		Session session = null;
		
		try{
		    session = sessionfactory.openSession();
		    Transaction tx = session.beginTransaction();
		    
		   /* Query query = session.createSQLQuery("DELETE FROM Pp_PlaceMaster WHERE PP_PLACEMASTERID='"+ppPlacemasterid+"'");*/
		    
			Query query = session.createSQLQuery(
					"DELETE FROM Pp_PlaceMaster WHERE PP_PLACEMASTERID=:PP_PLACEMASTERID");
			query.setParameter("PP_PLACEMASTERID", ppPlacemasterid);
		    
		    query.executeUpdate();
		    tx.commit();
		    
		    result = true;
		} 
		catch(Exception e){
			e.printStackTrace();
		}
		finally {
			session.close();
		}		
		return result;
	}

	@Override
	public int editPlace(PpPlacemaster placemaster) {
		Session session = null;
		int result = 0;
		try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
			session = sessionfactory.openSession();
			Transaction t = session.beginTransaction();
			
			session.createCriteria(placemaster.getPpPlacemasterid()+"");
			
			session.update(placemaster);
			session.flush();
			t.commit();
			result = 1;
			
		} 
		catch (Exception e) {
			e.printStackTrace();
		} finally {
			session.close();
		}
		return result;
	}
}
